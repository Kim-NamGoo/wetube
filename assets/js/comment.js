(()=>{const e=document.getElementById("videoContainer"),t=document.getElementById("commentForm");t&&t.addEventListener("submit",(async n=>{n.preventDefault();const a=t.querySelector("textarea"),d=e.dataset.id,c=a.value;if(""===c)return;const m=await fetch(`/api/videos/${d}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:c})});if(201===m.status){const{newCommentId:e}=await m.json();a.value="",((e,t)=>{const n=document.querySelector(".video__comments ul"),a=document.createElement("li"),d=document.createElement("span"),c=document.createElement("span");a.className="video__comment",a.dataset.commentid=t,c.className="video__comment-delete",d.innerText=`${e}`,c.innerText="âœ–",a.appendChild(d),a.appendChild(c),n.prepend(a),c.addEventListener("click",o)})(c,e)}}));let n=document.querySelectorAll(".video__comment-delete");const o=async t=>{const n=e.dataset.id,{commentid:o}=t.target.parentElement.dataset;await fetch(`/api/videos/${n}/comment/delete`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({commentid:o})}),(e=>{e.preventDefault();const t=document.querySelector(".video__comment"),n=e.target.parentElement;t.remove(n)})(t)};n.forEach((e=>e.addEventListener("click",o)))})();